<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Opiyo Okach</title>

    <!-- bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="overlay" class="container-fluid">
        <div class="row">
            <div class="col-12 d-flex align-items-center justify-content-center">
                <div>
                    <h1>Opiyo Okach Project</h1>
                    <h4>Instructions for computer</h4>
                    <p>Use your mouse to engage with the project</p>
                    <ul>
                        <li>click and drag with the mouse to orbit around the network</li>
                        <li>zoom in and out to move</li>
                        <li>click on the words to open the different chapters of the project</li>
                    </ul>
                    <h4>Instructions for touch screen</h4>
                    <ul>
                        <li>tag and drag to orbit around the network</li>
                        <li>pinch to zoom in and out</li>
                        <li>tap on words to open different chapters of the project</li>
                    </ul>
                </div>
            </div>
            <div class="col-12 text-center my-5">
                <button id="startButton" class="btn btn-light btn-lg">Play</button>
            </div>
        </div>
    </div>

    <div class="three-js-container">
      <canvas id="c"></canvas>
        <div class="labels">
        </div>
    </div>

    <div class="popupWindow">
        <h1>test</h1>
        <button id="close" class="btn btn-light btn-lg">close</button>
    </div>
    

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="globals.js"></script>

    <script type="module">

import * as THREE from 'https://threejsfundamentals.org/threejs/resources/threejs/r119/build/three.module.js';
// import { GUI } from 'https://threejsfundamentals.org/threejs/../3rdparty/dat.gui.module.js';
import { OrbitControls } from 'https://threejsfundamentals.org/threejs/resources/threejs/r119/examples/jsm/controls/OrbitControls.js';
// timer
let clock = new THREE.Clock();

// add cubes
// add a box
const boxWidth = 20;
const boxHeight = 10;
const boxDepth = 1;
const geometryBox = new THREE.BoxGeometry(boxWidth, boxHeight, boxDepth);
// const material = new THREE.MeshBasicMaterial({color: 0x44aa88});

const makeInstance = (geometry, x, y, z) => {
	const material = new THREE.MeshPhongMaterial({color: 0x00ff00});

	const cube = new THREE.Mesh(geometry, material);
	scene.add(cube);

	cube.position.set(  x, y, z );
	cube.material.transparent = true ;
	cube.material.opacity = 0;

	return cube;
};

let orbiting = false;
let viewing = true;

const main = () => {
	// remove start button
	console.log('init');
		var overlay = document.getElementById( 'overlay' );
		overlay.remove();

		// bring in camera
		camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 10000 );
		camera.position.set( 0, 25, 200 );

		// bring in audio listener
		var listener = new THREE.AudioListener();
		camera.add( listener );

		// scene
		scene = new THREE.Scene();
		scene.fog = new THREE.FogExp2( 0x000000, 0.0025 );

		// light
		light = new THREE.DirectionalLight( 0xffffff );
		light.position.set( 0, 0.5, 1 ).normalize();
		scene.add( light );
		

		// sound spheres
		var sphere = new THREE.SphereBufferGeometry( 20, 32, 16 );

		material1 = new THREE.MeshPhongMaterial( { color: 0xffaa00, flatShading: true, shininess: 0 } );
		material2 = new THREE.MeshPhongMaterial( { color: 0xff2200, flatShading: true, shininess: 0 } );
		material3 = new THREE.MeshPhongMaterial( { color: 0x6622aa, flatShading: true, shininess: 0 } );

		// sound spheres

		var audioLoader = new THREE.AudioLoader();

		var mesh1 = new THREE.Mesh( sphere, material1 );
		mesh1.position.set( - 250, 30, 0 );
		scene.add( mesh1 );

		var sound1 = new THREE.PositionalAudio( listener );
		audioLoader.load( 'assets/bensound-anewbeginning.ogg', function ( buffer ) {

			sound1.setLoop()
			sound1.setBuffer( buffer );
			sound1.setRefDistance( 20 );
			sound1.play();

		} );
		mesh1.add( sound1 );

		//

		var mesh2 = new THREE.Mesh( sphere, material2 );
		mesh2.position.set( 250, 30, 0 );
		scene.add( mesh2 );

		var sound2 = new THREE.PositionalAudio( listener );
		audioLoader.load( 'assets/bensound-creativeminds.ogg', function ( buffer ) {

			sound2.setLoop()
			sound2.setBuffer( buffer );
			sound2.setRefDistance( 20 );
			sound2.play();

		} );
		mesh2.add( sound2 );

		//

		var mesh3 = new THREE.Mesh( sphere, material3 );
		mesh3.position.set(  0, 30, - 250 );
		scene.add( mesh3 );

		var sound3 = new THREE.PositionalAudio( listener );
		audioLoader.load( 'assets/bensound-ukulele.ogg', function ( buffer ) {

			sound3.setLoop();
			sound3.setBuffer( buffer );
			sound3.setRefDistance( 20 );
			sound3.play();

		} );
		mesh3.add( sound3 );

		// analysers

		analyser1 = new THREE.AudioAnalyser( sound1, 32 );
		analyser2 = new THREE.AudioAnalyser( sound2, 32 );
		analyser3 = new THREE.AudioAnalyser( sound3, 32 );

		

		//

    // create canvas
    const canvas = document.querySelector('#c');
    const container = document.querySelector('.three-js-container');
    
		renderer = new THREE.WebGLRenderer( { canvas } );
		renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    container.appendChild( renderer.domElement );
		

		//

		// add controls
		controls = new OrbitControls( camera, renderer.domElement );
		controls.target.set(0, 5, 0);

		//
    
    renderer.render( scene, camera );

		const render = () => {
				renderer.render(scene, camera);
        requestAnimationFrame(render);
        
        
      }
      requestAnimationFrame(render);
		}

    
  



    
    let startButton = document.getElementById( 'startButton' );
startButton.addEventListener( 'click', () => {
	main();

} );


    </script>

</body>
</html>